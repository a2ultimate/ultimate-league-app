{% extends "layout/layout_user.html" %}

{% load games %}
{% load leagues %}
{% load utility %}

{% block content %}

	{% include "layout/account_tabs.html" with selected_tab="junta" %}

	{% if leagues %}
		<h1>Schedule Generation</h1>

		{% include "_partials/league_list.html" with leagues=leagues link_view="schedulegeneration_league" only %}
	{% else %}
		{% include "layout/league_header.html" with league=league header="Schedule Generation" only %}

		<table class="table table-striped">
			<tbody>
				{% for event in schedule %}
					<tr>
						{% for team in event %}
							{% if forloop.counter0|divisibleby:"2" %}
								<td class="text_center">
							{% endif %}

							<div>{{ team.id }}</div>

							{% if not forloop.counter0|divisibleby:"2" %}
								</td>
							{% endif %}
						{% endfor %}
					</tr>
				{% endfor %}
			</tbody>
		</table>


		{% for field in league.get_fields %}
			{% if field.field.layout_link %}
				<a href="{{ STATIC_URL }}{{ field.field.layout_link }}" target="_blank">
					<img src="{{ STATIC_URL }}{{ field.field.layout_link }}" height="300px">
				</a>
			{% endif %}
		{% endfor %}

		<p>
			There are {{ league.num_time_slots }} time slots, so you will have to
			choose at least {{ num_necessary_fields }} fields to play on. You may add
			exceptions and make changes in the admin interface after the schedule
			is created.
		</p>

		<form class="wide_form" method="post">{% csrf_token %}
			<div class="field_wrapper">
				{% for hidden in form.hidden_fields %}
					{{ hidden }}
				{% endfor %}
			</div>

			<table class="form_table">
				{% for field in form.visible_fields %}
					<tr>
						<td>{{ field.label_tag }}</td>
						<td class="wide_input">{{ field }}</td>
						<td>{{ field.help_text }}</td>
					</tr>
					{% if field.errors %}
						<tr>
							<td colspan="3">{{ field.errors }}</td>
						</tr>
					{% endif %}
				{% endfor %}
			</table>

			<input class="button button_success" type="submit" value="Submit Schedule">
			<a href="{% url 'schedulegeneration'  %}">Cancel</a>
		</form>
	{% endif %}
{% endblock %}
